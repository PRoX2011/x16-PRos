+---------------------------------------------------------------------------+
|                          User Applications                                |
|                                                                           |
|   +----------------------------+   +---------------------------------+    |
|   |        DOS Programs        |   |      Native PRos Programs       |    |
|   |          (.COM)            |   |            (.BIN)               |    |
|   |                            |   |                                 |    |
|   |  INT 20h / INT 21h DOS API |   |  PRos Native API (INT 0x21,22)  |    |
|   |  PSP-style environment     |   |                                 |    |
|   +-------------+--------------+   +--------------+------------------+    |
|                 |                                 |                       |
+-----------------|---------------------------------|-----------------------+
                  |                                 |
                  v                                 v
+---------------------------------------------------------------------------+
|                  Program Loader / Execution Control                       |
|                                                                           |
|   - File type detection (.COM / .BIN)                                     |
|   - Execution mode selection                                              |
|   - Context preparation                                                   |
+---------------------------------------------------------------------------+
                  |                                |
                  | API Switch                     | API Switch
                  v                                v
+-------------------------------+     +-------------------------------------+
|     DOS Compatibility Mode    |     |        Native PRos Mode             |
|                               |     |                                     |
|  - INT 21h Dispatcher         |     |  - PRos API Interface               |
|  - INT 20h Termination        |     |                                     |
|                               |     |                                     |
+---------------+---------------+     +---------------+---------------------+
                |                                     |
                +-------------------+-----------------+
                                    |
                                    v
+---------------------------------------------------------------------------+
|                               Kernel                                      |
|                                                                           |
|   Core Services                                                           |
|   - Segment and stack management                                          |
|   - Interrupt vector management                                           |
|                                                                           |
|   Execution Control                                                       |
|   - Context switch (.COM or .BIN)                                         |
|   - Safe return to shell                                                  |
+---------------------------------------------------------------------------+
                                    |
                                    v
+---------------------------------------------------------------------------+
|                     Drivers / BIOS Abstraction                            |
|                                                                           |
|   - Video (INT 10h)                                                       |
|   - Keyboard (INT 16h)                                                    |
|   - Timer / RTC (INT 1Ah)                                                 |
|   - Serial (INT 14h)                                                      |
|   - Disk (INT 13h)                                                        |
+---------------------------------------------------------------------------+
                                    |
                                    v
+---------------------------------------------------------------------------+
|                                Hardware                                   |
+---------------------------------------------------------------------------+
